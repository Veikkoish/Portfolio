---
import type { Project } from '../../config/projects';
import { publicPath } from '../../config/projects';
import ProjectHeader from '../shared/ProjectHeader.astro';
import ProjectMenu from '../shared/ProjectMenu.astro';
import SectionHeading from '../shared/SectionHeading.astro';
import BackButton from '../shared/BackButton.astro';
import SkillTag from '../SkillTag.astro';

interface Props {
  project: Project;
}

const { project } = Astro.props;
---

<main class="container mx-auto px-4 md:px-8 py-8 md:py-12">
  <ProjectHeader title={project.title} year={project.year} inProgress={project.inProgress} />
  <ProjectMenu sections={['overview', 'technology', 'process', 'gallery']} />

  <div class="max-w-6xl mx-auto space-y-16 md:space-y-24">
    <!-- Overview Section -->
    <section id="overview" class="section-content scroll-mt-32">
      <div class="space-y-10 md:space-y-16">
        {project.overview?.map((section) => (
          section.image ? (
            <div class={`flex flex-col md:flex-row gap-6 md:gap-12 items-center ${section.imagePosition === 'right' ? 'md:flex-row-reverse' : ''}`}>
              <div class="w-full md:w-1/2">
                <img src={section.image} alt={project.title} class="rounded-2xl w-full" />
              </div>
              <div class="w-full md:w-1/2">
                <p class="text-base md:text-lg text-gray-300 leading-relaxed whitespace-pre-line">
                  {section.description}
                </p>
              </div>
            </div>
          ) : (
            <div>
              <p class="text-base md:text-lg text-gray-300 leading-relaxed whitespace-pre-line">
                {section.description}
              </p>
            </div>
          )
        ))}
      </div>
    </section>

    <!-- Technology Section -->
    <section id="technology" class="section-content scroll-mt-32">
      <SectionHeading>Technology</SectionHeading>
      <div class="flex flex-wrap gap-3 mb-12">
        {project.skills.map((skill) => (
          <SkillTag name={skill.name} category={skill.category} />
        ))}
      </div>
      
      <SectionHeading level={3}>Hardware</SectionHeading>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6">
        <div>
          <img
            src={publicPath('Omniframe/omni_diagram.webp')}
            alt="Omniframe system diagram"
            class="rounded-2xl w-full"
          />
        </div>
        <div>
          <img
            src={publicPath('Omniframe/v4_board.webp')}
            alt="Omniframe v4 board"
            class="rounded-2xl w-full"
          />
        </div>
      </div>
      <div class="mt-4 md:mt-8 grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6">
        <div>
          <img
            src={publicPath('Omniframe/v4_hardware_assembly.webp')}
            alt="Omniframe main schematic"
            class="rounded-2xl w-full"
          />
        </div>
        <div>
          <img
            src={publicPath('Omniframe/final_board_layout.webp')}
            alt="Omniframe final board layout"
            class="rounded-2xl w-full"
          />
        </div>
      </div>
      
      <SectionHeading level={3} class="mt-8 md:mt-12">Materials</SectionHeading>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6 mb-6 md:mb-8">
        <div>
          <img
            src={publicPath('Omniframe/frame.webp')}
            alt="Omniframe frame"
            class="rounded-2xl w-full"
          />
        </div>
        <div>
          <img
            src={publicPath('Omniframe/backboard.webp')}
            alt="Omniframe backboard"
            class="rounded-2xl w-full"
          />
        </div>
        <div>
          <img
            src={publicPath('Omniframe/diffuser.webp')}
            alt="Omniframe diffuser"
            class="rounded-2xl w-full"
          />
        </div>
      </div>
      <p class="text-base md:text-lg text-gray-300 leading-relaxed">
        The frame is CNC machined from acacia wood. The backboard for V3 was resin-printed, while V4's backboard was CNC machined from ABS to develop it closer toward injection molding. The diffuser is 60% translucent and coated with a diffusing spray to hide the solar cells while allowing sufficient light transmission to continuously charge the device.
      </p>
      
      <SectionHeading level={3} class="mt-8 md:mt-12">Specifications</SectionHeading>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-8 text-base md:text-lg">
        <div class="space-y-6">
          <div>
            <h4 class="text-lg font-semibold mb-2 text-gray-200">Display</h4>
            <ul class="space-y-1 text-gray-300">
              <li><span class="text-gray-400">Size:</span> 13.3 inches (27 x 20 cm)</li>
              <li><span class="text-gray-400">Resolution:</span> 1600 x 1200 pixels</li>
              <li><span class="text-gray-400">Grayscale Depth:</span> 256 shades</li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-2 text-gray-200">Frame</h4>
            <ul class="space-y-1 text-gray-300">
              <li><span class="text-gray-400">Measurements:</span> 17 x 14 inches (44 x 36 cm)</li>
              <li><span class="text-gray-400">Material:</span> Acacia hardwood</li>
              <li><span class="text-gray-400">Mounting:</span> Rotating wall mount</li>
            </ul>
          </div>
        </div>
        <div class="space-y-6">
          <div>
            <h4 class="text-lg font-semibold mb-2 text-gray-200">Energy</h4>
            <ul class="space-y-1 text-gray-300">
              <li><span class="text-gray-400">Battery Capacity:</span> 12,000 mAh</li>
              <li><span class="text-gray-400">Battery Life:</span> Over 1 year</li>
              <li><span class="text-gray-400">Charging Port:</span> USB-C</li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-semibold mb-2 text-gray-200">Other Features</h4>
            <ul class="space-y-1 text-gray-300">
              <li><span class="text-gray-400">Connectivity:</span> Wi-Fi and Bluetooth LE</li>
              <li><span class="text-gray-400">Internal Storage:</span> 4 GB</li>
              <li><span class="text-gray-400">Buttons:</span> Sync and Reset</li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <!-- Process Section -->
    <section id="process" class="section-content scroll-mt-32">
      <SectionHeading>Process</SectionHeading>
      
      <SectionHeading level={3}>V1</SectionHeading>
      <p class="text-base md:text-lg text-gray-300 leading-relaxed mb-6 md:mb-8">
        The first version was done with an acrylic backplate and different boards soldered together on a resin printed holder and had individual solar cells soldered together on nickel strips.
      </p>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6 mb-10 md:mb-16">
        <div class="h-64 md:h-96 overflow-hidden rounded-2xl">
          <img
            src={publicPath('Omniframe/v1.webp')}
            alt="Omniframe v1"
            class="w-full h-full object-cover rounded-2xl"
          />
        </div>
        <div class="h-64 md:h-96 overflow-hidden rounded-2xl">
          <img
            src={publicPath('Omniframe/v1_inside.webp')}
            alt="Omniframe v1 inside"
            class="w-full h-full object-cover rounded-2xl"
          />
        </div>
        <div class="h-64 md:h-96 overflow-hidden rounded-2xl">
          <img
            src={publicPath('Omniframe/v1_hardware.webp')}
            alt="Omniframe v1 hardware"
            class="w-full h-full object-cover rounded-2xl"
          />
        </div>
      </div>
      
      <SectionHeading level={3}>V2</SectionHeading>
      <div class="w-full">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6 mb-4 md:mb-6">
          <div class="h-64 md:h-96 overflow-hidden rounded-2xl">
            <video
              src={publicPath('Omniframe/v2.mp4')}
              autoplay
              loop
              muted
              playsinline
              class="w-full h-full object-cover"
            ></video>
          </div>
          <div class="flex items-center">
            <p class="text-base md:text-lg text-gray-300 leading-relaxed">
              The form factor turned closer to the final product, and had a better diffuser made from special coated translucent acrylic. And second-generation custom PCB that skipped the display driver IC that the first generation had and instead used low-level driver firmware to drive the display directly with the ESP.
            </p>
          </div>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6">
          <div class="h-64 md:h-96 overflow-hidden rounded-2xl">
            <video
              src={publicPath('Omniframe/cnc.mp4')}
              autoplay
              loop
              muted
              playsinline
              class="w-full h-full object-cover"
            ></video>
          </div>
          <div class="h-64 md:h-96 overflow-hidden rounded-2xl">
            <img
              src={publicPath('Omniframe/v2_hardware.webp')}
              alt="Omniframe v2 hardware"
              class="w-full h-full object-cover"
            />
          </div>
        </div>
      </div>
      
      <SectionHeading level={3} class="mt-10 md:mt-16">V3 & V4</SectionHeading>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6 mb-4 md:mb-6">
        <div class="h-64 md:h-110 overflow-hidden rounded-2xl">
          <img
            src={publicPath('Omniframe/v3_drawing.webp')}
            alt="Omniframe v3 drawing"
            class="w-full h-full object-cover"
          />
        </div>
        <div class="flex items-center">
          <p class="text-base md:text-lg text-gray-300 leading-relaxed">
            DFM and DFA were the major focuses of V3 and V4. The total number of components was significantly reduced and the backboard was designed for injection molding. The hardware assembly featured a unified solar cell, an improved main logic board with refined power architecture, production opimizations, and SD card holder, and a secondary board with button and USB-C port, connected via ribbon cable.
          </p>
        </div>
      </div>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6">
        <div class="h-64 md:h-106 overflow-hidden rounded-2xl">
          <img
            src={publicPath('Omniframe/v4_backboard.webp')}
            alt="Omniframe v4 backboard"
            class="w-full h-full object-cover brightness-70"
          />
        </div>
        <div class="h-64 md:h-106 overflow-hidden rounded-2xl">
          <img
            src={publicPath('Omniframe/v4_allhw.webp')}
            alt="Omniframe v4 hardware assembly"
            class="w-full h-full object-cover brightness-80"
          />
        </div>
      </div>
    </section>

    <!-- Gallery Section -->
    <section id="gallery" class="section-content scroll-mt-32">
      <SectionHeading>Gallery</SectionHeading>
      <div class="space-y-4 md:space-y-6">
        <p class="text-base md:text-lg text-gray-300 leading-relaxed">
          For more information about the project, including technical specifications, repositories, and the latest updates, visit the official project website.
        </p>
        <a
          href="https://omniframe.org"
          target="_blank"
          rel="noopener noreferrer"
          class="inline-block text-lg mt-4"
          style="color:rgb(69, 120, 164); text-decoration: underline;"
        >
          Visit omniframe.org â†’
        </a>
      </div>
    </section>

    <BackButton />
  </div>
</main>

